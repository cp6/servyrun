import{A as L}from"./AuthenticatedLayout-b0ac98cc.js";import{u,b as U,r as n,j as a,a as e,H as q,c as M}from"./app-7082a047.js";import{M as b,B as _}from"./Toast-a9c7a83a.js";import"./Table-13305096.js";import{H as K,a as X,B as z,e as G,C as J}from"./index.esm-eebfcfab.js";import{I as p}from"./InputLabel-04829bce.js";import{T as h,I as g}from"./TextInput-38986df9.js";import{P as f}from"./PrimaryButton-aae876dd.js";import{O as V}from"./Output-dd9f99a9.js";import{R as Y}from"./Alert-af0dbb46.js";import{B as Q}from"./BackButton-c0685269.js";import{P as W}from"./ProgressBar-e6470a9f.js";import{a as Z}from"./axios-4a70c6fc.js";import"./ApplicationLogo-db4f8950.js";import"./transition-eb04b526.js";import"./index-9b0dda6f.js";function fe({auth:S}){const r=u().props.resource,C=u().props.ip,I=u().props.alert,{data:l,setData:o,post:P,processing:m,reset:$,errors:i}=U({the_command1:"",file:"",save_as:""}),[d,x]=n.useState(!1),[T,v]=n.useState(null),[E,y]=n.useState(!1),[B,w]=n.useState(0),[c,N]=n.useState(!1);n.useEffect(()=>{let t;return c?t=setInterval(()=>{w(s=>s+10)},10):c||clearInterval(t),()=>clearInterval(t)},[c]);async function F(){w(0),N(!0);const t=await fetch(route("sftp.run",r.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content"),"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({the_command1:l.the_command1})});return N(!1),t.json()}const D=t=>{t.preventDefault();const s=document.getElementById("command_output_div"),H=M.createRoot(s);F().then(k=>{const j=e(V,{id:"commandOutput",title:null,the_command:l.the_command1,created_at:new Date,the_output:k.output,seconds:k.seconds_taken,rows:10});H.render(j)})};async function R(t){return await(await Z.get(route("sftp.upload.progress",t.id))).data}n.useEffect(()=>{let t;return d?t=setInterval(()=>{R(r).then(s=>{v(s.progress)})},500):d||(v(null),clearInterval(t)),()=>clearInterval(t)},[d]);const O=t=>{t.preventDefault(),P(route("sftp.upload",r.id),{onStart:s=>{x(!0)},onFinish:s=>{x(!1)}})},A=()=>{const t={method:"DELETE",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content")}};fetch(route("sftp.destroy",r.id),t).then(s=>{s.redirected&&(window.location.href=s.url)})};return a(L,{auth:S,header:a("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:[r.username,"@",C,":",r.port," (",r.server.hostname,")"]}),children:[e(q,{title:"SFTP connection "+r.id}),a("div",{className:"py-8 px-2 mx-auto max-w-7xl lg:py-10",children:[e("div",{className:"flex flex-wrap gap-2 mb-4",children:e(Q,{href:route("sftp.index"),children:"Back to SFTP connections"})}),e(Y,{details:I}),a("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg shadow-sm",children:[a("div",{className:"py-6 px-4 mx-auto max-w-7xl",children:[a("div",{className:"flex items-center justify-between mb-4",children:[e("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Run SFTP command"}),a("small",{className:"text-end",children:[e(K,{className:"mr-2 h-6 w-6 text-gray-600 dark:text-white hover:text-gray-700 hover:dark:text-gray-300 inline hover:cursor-pointer",onClick:()=>y(!0),title:"Delete SFTP connection"}),e(X,{className:"md:ml-2 ml-1 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("sftp.edit",r.id),title:"Edit SFTP connection"}),e(z,{className:"md:ml-2 ml-1 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("sftp.read",r.id),title:"Read a file"}),e(G,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("server.show",r.server.id),title:"Go to server"}),e(J,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("sftp.create-download-to-server",r.id),title:"Download a file to this host server"})]})]}),a("form",{onSubmit:D,children:[e("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-4 sm:gap-4",children:a("div",{className:"col-span-4",children:[e(p,{forInput:"the_command1",value:"Command"}),e(h,{name:"the_command1",value:l.the_command1,className:"mt-1 block w-full",autoComplete:"the_command1",handleChange:t=>o("the_command1",t.target.value),maxLength:64,required:!0}),e(g,{message:i.the_command1,className:"mt-2"})]})}),e(f,{className:"inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",processing:m,children:"Run"})]})]}),a("div",{className:"py-2 px-4 mx-auto max-w-7xl",children:[a("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-4 sm:gap-4",children:[e("div",{className:"col-span-2",children:a("form",{action:route("sftp.download",r.id),method:"post",children:[e("input",{type:"hidden",name:"_token",value:document.getElementsByName("csrf-token")[0].getAttribute("content")}),e("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-4 sm:gap-4",children:a("div",{className:"col-span-4",children:[e("p",{className:"text-lg text-gray-800 dark:text-white pb-2",children:"Download a file"}),e(p,{forInput:"file",value:"Full file path and name"}),e(h,{name:"file",value:l.file,className:"mt-1 block w-full",autoComplete:"file",handleChange:t=>o("file",t.target.value),maxLength:255,required:!0}),e(g,{message:i.file,className:"mt-2"})]})}),e(f,{className:"inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",processing:m,children:"Download file"})]})}),e("div",{className:"col-span-2",children:a("form",{onSubmit:O,children:[a("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-4 sm:gap-4",children:[a("div",{className:"col-span-3",children:[e("p",{className:"text-lg text-gray-800 dark:text-white pb-2",children:"Upload a file"}),e(p,{forInput:"save_as",value:"Save as"}),e(h,{name:"save_as",value:l.save_as,className:"mt-1 block w-full",autoComplete:"file",handleChange:t=>o("save_as",t.target.value),maxLength:255,required:!0}),e(g,{message:i.save_as,className:"mt-2"})]}),a("div",{className:"col-span-1",children:[e("p",{className:"text-lg text-gray-800 dark:text-white pb-2",children:"â€Œ"}),e("label",{className:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"File"}),e("input",{type:"file",className:"w-full px-4 py-2",name:"the_file",onChange:t=>o("the_file",t.target.files[0])}),e("span",{className:"text-red-600",children:i.the_file})]})]}),e(f,{className:"inline-flex items-center px-5 py-2.5 mt-3",processing:m,children:"Upload file"})]})})]}),e(W,{value:T})]})]}),a("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg mt-4",children:[e("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white pl-4 pt-2",children:"SFTP Command output"}),e("div",{className:"pt-2 px-4 mx-auto max-w-7xl",children:c?a("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:[e("code",{className:"text-red-500 bg-gray-300 dark:bg-black p-1 rounded-md my-2",children:l.the_command1??null})," ",B/1e3%60,"s"]}):null}),e("div",{className:"py-4 px-4 mx-auto max-w-7xl",id:"command_output_div",children:e("span",{className:"text-gray-400 dark:text-gray-500",children:"Nothing run yet"})})]})]}),e(b,{show:E,size:"md",children:e(b.Body,{children:a("div",{className:"text-center",children:[e("h3",{className:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this SFTP Connection?"}),a("div",{className:"flex justify-center gap-4",children:[e(_,{color:"failure",onClick:A,children:"Yes, I'm sure"}),e(_,{onClick:()=>y(!1),color:"gray",children:"No, cancel"})]})]})})})]})}export{fe as default};
