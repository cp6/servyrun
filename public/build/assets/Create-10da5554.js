import{A as w}from"./AuthenticatedLayout-c4be06bd.js";import{u as c,R as n,b as I,j as t,a,H as S}from"./app-a8d4275f.js";import{I as o}from"./InputLabel-a7ee92ff.js";import{T as C,I as A}from"./TextInput-1e9aadbd.js";import{S as u}from"./Toast-ee00046f.js";import"./Table-f19b692a.js";import{P as B}from"./PrimaryButton-19cc4f5a.js";import{R as P}from"./Alert-d503f44b.js";import{a as R}from"./axios-4a70c6fc.js";import{B as j}from"./BackButton-2b60c346.js";import"./ApplicationLogo-ae419612.js";import"./transition-fbe58e1e.js";import"./index.esm-2010c99b.js";function V({auth:p}){const h=c().props.alert,i=c().props.connections,[s,b]=n.useState(""),{data:l,setData:r,post:g,processing:f,reset:q,errors:v}=I({db_connection_id:null,name:s,name_select:s}),[x,N]=n.useState([]),[_,d]=n.useState(1),y=e=>{e.preventDefault(),g(route("db.store")),navigate(route("db.index"))},D=e=>{r("db_connection_id",e.target.value),e.target.value!==""&&R.get(route("db.connection.databases",e.target.value)).then(m=>{N(m.data.databases),d(0)}).catch(m=>{d(1)})},k=e=>{r("name",e.target.value),b(e.target.value)};return t(w,{auth:p,header:a("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:"Add a database"}),children:[a(S,{title:"Add database"}),t("div",{className:"py-8 sm:px-0 px-1 mx-auto max-w-7xl lg:py-10",children:[a("div",{className:"flex flex-wrap gap-2 mb-4",children:a(j,{href:route("db.index"),children:"Back to databases"})}),a(P,{details:h}),a("div",{className:"bg-white dark:bg-gray-700 overflow-hidden shadow-sm sm:rounded-lg p-2 sm:p-6",children:i.length===0?a("p",{className:"text-gray-600 dark:text-gray-300",children:"Please create a database connection first"}):t("form",{onSubmit:y,children:[t("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-6 sm:gap-4",children:[t("div",{className:"sm:col-span-2 col-span-4",children:[a("div",{className:"mb-2 block",children:a(o,{forInput:"db_connection_id",value:"Database connection"})}),t(u,{onChange:D,name:"db_connection_id",required:!0,value:l.db_connection_id,children:[a("option",{value:"",children:"Choose"}),i.map(e=>t("option",{value:e.id,children:[e.host," (",e.title,")"]},e.id))]})]}),t("div",{className:"sm:col-span-2 col-span-4",children:[a(o,{forInput:"name",value:"Database name"}),a(C,{name:"name",className:"mt-1 block w-full",autoComplete:"name",value:l.name,handleChange:e=>r("name",e.target.value),maxLength:64,required:!0}),a(A,{message:v.name,className:"mt-2"})]}),t("div",{className:"sm:col-span-2 col-span-4",children:[a("div",{className:"mb-2 block",children:a(o,{forInput:"name_select",value:"Database name"})}),t(u,{onChange:k,name:"name_select",value:s,disabled:_,required:!0,children:[a("option",{value:"",children:"Choose a connection first"}),x.map(e=>a("option",{value:e,children:e},e))]})]})]}),a(B,{className:"inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",processing:f,children:"Add database"})]})})]})]})}export{V as default};
