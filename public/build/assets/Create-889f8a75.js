import{A as L}from"./AuthenticatedLayout-e0b7f8ec.js";import{u as p,b as D,R as d,j as t,a,H as B}from"./app-3b14edf2.js";import{I as l}from"./InputLabel-8665140f.js";import{T as c,I as m}from"./TextInput-edb2b3ad.js";import{S as r}from"./Toast-1f814f61.js";import"./Table-29b362e9.js";import{P as M}from"./PrimaryButton-28166509.js";import{R as Q}from"./Alert-10dd726c.js";import{a as u}from"./axios-468742d6.js";import{B as R}from"./BackButton-d8b9f37c.js";import"./ApplicationLogo-30229999.js";import"./transition-da3d9d06.js";import"./index.esm-b46f3593.js";function V({auth:h}){const v=p().props.alert,g=p().props.servers,{data:n,setData:s,post:_,processing:b,reset:T,errors:i}=D({connection_id:"",server_id:"",database_name:"",db_connection_id:"",certain_tables:"",save_to:"",save_as:"dump.sql",option:"",compress:"0",custom_flags:"",these_tables:""}),[f,N]=d.useState([]),[C,x]=d.useState([]),[y,k]=d.useState([]),I=e=>{e.preventDefault(),_(route("mysqldump.store")),navigate(route("mysqldump.index"))},S=e=>{s("server_id",e.target.value),e.target.value!==""&&(u.get(route("server.connections",e.target.value)).then(o=>{N(o.data)}).catch(o=>{}),u.get(route("server.db.connections",e.target.value)).then(o=>{x(o.data)}).catch(o=>{}))},w=e=>{s("db_connection_id",e.target.value),e.target.value!==""&&u.get(route("db.connection.databases",e.target.value)).then(o=>{k(o.data.databases)}).catch(o=>{})},q=e=>{s(o=>({...o,database_name:e.target.value}))};return t(L,{auth:h,header:a("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:"Create MySQL dump"}),children:[a(B,{title:"Create MySQL dump"}),t("div",{className:"py-8 px-2 mx-auto max-w-7xl lg:py-10",children:[a("div",{className:"flex flex-wrap gap-2 mb-4",children:a(R,{href:route("mysqldump.index"),children:"Back to MySQL dumps"})}),a(Q,{details:v}),a("div",{className:"bg-white dark:bg-gray-700 overflow-hidden shadow-sm sm:rounded-lg p-2 sm:p-6",children:t("form",{onSubmit:I,children:[t("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-6 sm:gap-4",children:[t("div",{className:"sm:col-span-3 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"server_id",value:"Server"})}),t(r,{onChange:S,name:"server_id",required:!0,value:n.server_id,handleChange:e=>s("server_id",e.target.value),children:[a("option",{value:"",children:"Choose"}),g.map(e=>t("option",{value:e.id,children:[e.hostname," (",e.title,")"]},e.id))]})]}),t("div",{className:"sm:col-span-3 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"connection_id",value:"Server connection"})}),t(r,{onChange:e=>s("connection_id",e.target.value),name:"connection_id",required:!0,value:n.connection_id,handleChange:e=>s("connection_id",e.target.value),children:[a("option",{value:"",children:"Choose a server with a connection"}),f.map(e=>t("option",{value:e.id,children:["User: ",e.username," (",e.id,")"]},e.id))]})]}),t("div",{className:"sm:col-span-3 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"db_connection_id",value:"Database connection"})}),t(r,{onChange:w,name:"db_connection_id",value:n.db_connection_id,handleChange:e=>s("db_connection_id",e.target.value),children:[a("option",{value:"",children:"Choose"}),C.map(e=>t("option",{value:e.id,children:[e.host," (",e.title,")"]},e.id))]})]}),t("div",{className:"sm:col-span-3 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"database_name",value:"Database"})}),t(r,{onChange:q,name:"database_name",required:!0,value:n.database_name,handleChange:e=>s("database_name",e.target.value),children:[a("option",{value:"",children:"Choose"}),y.map(e=>a("option",{value:e,children:e},e))]})]}),t("div",{className:"sm:col-span-3 col-span-4",children:[a(l,{forInput:"save_to",value:"Save to"}),a(c,{name:"save_to",className:"mt-1 block w-full",autoComplete:"save_to",value:n.save_to,handleChange:e=>s("save_to",e.target.value),maxLength:64}),a(m,{message:i.save_to,className:"mt-2"})]}),t("div",{className:"sm:col-span-3 col-span-4",children:[a(l,{forInput:"save_as",value:"Save as"}),a(c,{name:"save_as",className:"mt-1 block w-full",autoComplete:"save_as",value:n.save_as,handleChange:e=>s("save_as",e.target.value),maxLength:64}),a(m,{message:i.save_as,className:"mt-2"})]}),t("div",{className:"sm:col-span-2 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"option",value:"Options"})}),t(r,{onChange:e=>s("option",e.target.value),name:"option",required:!0,value:n.option,handleChange:e=>s("option",e.target.value),children:[a("option",{value:"0",children:"None"}),a("option",{value:"1",children:"--quick"}),a("option",{value:"2",children:"--opt"}),a("option",{value:"3",children:"--add-locks"}),a("option",{value:"4",children:"--single-transaction"})]})]}),t("div",{className:"sm:col-span-2 col-span-4",children:[a(l,{forInput:"custom_flags",value:"Custom flags"}),a(c,{name:"custom_flags",className:"mt-1 block w-full",autoComplete:"custom_flags",value:n.custom_flags,handleChange:e=>s("custom_flags",e.target.value),maxLength:64}),a(m,{message:i.custom_flags,className:"mt-2"})]}),t("div",{className:"sm:col-span-1 col-span-4",children:[a("div",{className:"mb-2 block",children:a(l,{forInput:"compress",value:"Compress"})}),t(r,{onChange:e=>s("compress",e.target.value),name:"compress",required:!0,value:n.compress,handleChange:e=>s("compress",e.target.value),children:[a("option",{value:"0",children:"No"}),a("option",{value:"1",children:"Yes"})]})]}),t("div",{className:"col-span-6",children:[a(l,{forInput:"these_tables",value:"These tables only (separate by space)"}),a(c,{name:"these_tables",className:"mt-1 block w-full",autoComplete:"these_tables",value:n.these_tables,handleChange:e=>s("these_tables",e.target.value),maxLength:255}),a(m,{message:i.these_tables,className:"mt-2"})]})]}),a(M,{className:"inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",processing:b,children:"Create MySQL dump"})]})})]})]})}export{V as default};
