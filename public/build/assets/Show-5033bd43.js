import{A as H}from"./AuthenticatedLayout-c4be06bd.js";import{u as s,r as i,b as M,j as a,a as e,H as P,c as F}from"./app-a8d4275f.js";import{S as L,M as v,B as y}from"./Toast-ee00046f.js";import"./Table-f19b692a.js";import{H as K,a as X,e as q,f as z}from"./index.esm-2010c99b.js";import{I as d}from"./InputLabel-a7ee92ff.js";import{T as w,I as h}from"./TextInput-1e9aadbd.js";import{P as G}from"./PrimaryButton-19cc4f5a.js";import{O as J}from"./Output-2c144da2.js";import{R as Q}from"./Alert-d503f44b.js";import{B as V}from"./BackButton-2b60c346.js";import"./ApplicationLogo-ae419612.js";import"./transition-fbe58e1e.js";import"./index-9b0dda6f.js";function de({auth:N}){const k=s().props.alert,o=s().props.resource,b=s().props.method,_=s().props.ip,C=s().props.commands,[p,I]=i.useState(!1),[E,g]=i.useState(0),[m,x]=i.useState(!1),S=t=>{I(t.target.checked),n.email=t.target.checked},{data:n,setData:c,post:Y,processing:B,reset:U,errors:u}=M({the_command1:"",command_id:"",timeout:"10",email:""});i.useEffect(()=>{let t;return m?t=setInterval(()=>{g(r=>r+10)},10):m||clearInterval(t),()=>clearInterval(t)},[m]);const[T,f]=i.useState(!1);async function R(){g(0),x(!0);const t=await fetch(route("connection.run",o.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content"),"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({the_command1:n.the_command1,command_id:n.command_id||null,timeout:n.timeout||10,email:n.email||!1})});return x(!1),t.json()}const O=t=>{t.preventDefault();const r=document.getElementById("command_output_div"),A=F.createRoot(r);R().then(l=>{const D=e(J,{id:"commandOutput",title:null,the_command:l.the_command,created_at:new Date,the_output:l.output??l.message,seconds:l.seconds_taken,rows:10});A.render(D),c("command_id","")})},j=()=>{const t={method:"DELETE",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content")}};fetch(route("connection.destroy",o.id),t).then(r=>{r.redirected&&(window.location.href=r.url)})};return a(H,{auth:N,header:a("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:[o.username,"@",_,":",o.ssh_port," (",o.server.hostname,") with a ",b.string]}),children:[e(P,{title:"Connection "+o.id}),a("div",{className:"py-8 sm:px-0 px-1 mx-auto max-w-7xl lg:py-10",children:[e("div",{className:"flex flex-wrap gap-2 mb-4",children:e(V,{href:route("connection.index"),children:"Back to connections"})}),e(Q,{details:k}),e("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg shadow-sm",children:a("div",{className:"py-4 px-4 mx-auto max-w-7xl",children:[a("div",{className:"flex items-center justify-between mb-4",children:[e("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Run command"}),a("small",{className:"text-end",children:[e(K,{className:"mr-2 h-6 w-6 text-gray-600 dark:text-white hover:text-gray-700 hover:dark:text-gray-300 inline hover:cursor-pointer",onClick:()=>f(!0),title:"Delete connection"}),e(X,{className:"md:ml-2 ml-1 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("connection.edit",o.id),title:"Edit connection"}),e(q,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("server.show",o.server.id),title:"Go to server"}),e(z,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:t=>window.location.href=route("connection.debug",o.id),title:"Debug connection"})]})]}),a("form",{onSubmit:O,children:[a("div",{className:"grid gap-2 sm:grid-cols-1 md:grid-cols-4 sm:gap-4",children:[a("div",{className:"sm:col-span-4 col-span-4",children:[e(d,{forInput:"the_command1",value:"Command"}),e(w,{handleChange:t=>c("the_command1",t.target.value),name:"the_command1",value:n.the_command1,className:"mt-1 block w-full",autoComplete:"the_command1",maxLength:64}),e(h,{message:u.the_command1,className:"mt-2"})]}),a("div",{className:"sm:col-span-2 col-span-4",children:[e("div",{className:"mb-2 block",children:e(d,{forInput:"command_id",value:"From commands"})}),a(L,{onChange:t=>c("command_id",t.target.value),name:"command_id",value:n.command_id,children:[e("option",{value:"",children:"Choose"}),C.map(t=>e("option",{value:t.id,children:t.title},t.id))]})]}),a("div",{className:"sm:col-span-1 col-span-4",children:[e(d,{forInput:"timeout",value:"Timeout"}),e(w,{type:"number",name:"timeout",className:"mt-1 block w-full",autoComplete:"timeout",value:n.timeout,handleChange:t=>c("timeout",t.target.value),min:1,max:999999}),e(h,{message:u.timeout,className:"mt-2"})]}),a("div",{className:"sm:col-span-1 col-span-4",children:[e(d,{forInput:"email",value:"Send output to email"}),e("input",{type:"checkbox",name:"email",value:p?1:0,onChange:S,checked:p}),e(h,{message:u.email,className:"mt-2"})]})]}),e(G,{className:"inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900",processing:B,children:"Run"})]})]})}),a("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg mt-4",children:[e("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white pl-4 pt-2",children:"Command output"}),e("p",{className:"pl-4 text-gray-700 dark:text-gray-300",children:e("a",{href:route("outputs.show.server",o.server.id),children:"View all"})}),e("div",{className:"pt-2 px-4 mx-auto max-w-7xl",children:m?a("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:[e("code",{className:"text-red-500 bg-gray-300 dark:bg-black p-1 rounded-md my-2",children:n.the_command1??null})," ",E/1e3%60,"s"]}):null}),e("div",{className:"py-4 px-4 mx-auto max-w-7xl",id:"command_output_div",children:e("span",{className:"text-gray-400 dark:text-gray-500",children:"No output yet"})})]})]}),e(v,{show:T,size:"md",children:e(v.Body,{children:a("div",{className:"text-center",children:[e("h3",{className:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this Connection?"}),a("div",{className:"flex justify-center gap-4",children:[e(y,{color:"failure",onClick:j,children:"Yes, I'm sure"}),e(y,{onClick:()=>f(!1),color:"gray",children:"No, cancel"})]})]})})})]})}export{de as default};
