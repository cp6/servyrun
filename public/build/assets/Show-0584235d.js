import{A as k}from"./AuthenticatedLayout-c4be06bd.js";import{u as n,r as c,j as r,a as e,H as N}from"./app-a8d4275f.js";import{M as m,B as h}from"./Toast-ee00046f.js";import"./Table-f19b692a.js";import{H as v,j as B,l as z}from"./index.esm-2010c99b.js";import{R as E}from"./Alert-d503f44b.js";import{a as u}from"./axios-4a70c6fc.js";import{B as A}from"./BackButton-2b60c346.js";import{n as x}from"./helpers-2aabf79e.js";import"./ApplicationLogo-ae419612.js";import"./transition-fbe58e1e.js";function P({auth:g}){const p=n().props.alert,a=n().props.resource,l=n().props.tables,i=n().props.auth.user,[f,d]=c.useState(!1),[C,o]=c.useState(!1),b=()=>{const t={method:"DELETE",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content")}};fetch(route("db.show.tables.destroy",[a.id]),t).then(s=>{s.redirected&&(window.location.href=s.url)})},w=()=>{o(!0);const t={headers:{Authorization:`Bearer ${i.api_token}`}};u.get(route("api.db.refresh",a.id),t).then(s=>{window.location.reload()}).catch(s=>{console.log("Error refreshing tables"),o(!1)})},y=()=>{o(!0);const t={headers:{Authorization:`Bearer ${i.api_token}`}};u.get(route("api.db.table.size",a.id),t).then(s=>{window.location.reload()}).catch(s=>{console.log("Error refreshing tables"),o(!1)})};return r(k,{auth:g,header:e("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:a.name+" tables"}),children:[e(N,{title:a.name+" tables"}),r("div",{className:"py-8 sm:px-0 px-1 mx-auto max-w-7xl lg:py-10",children:[e("div",{className:"flex flex-wrap gap-2 mb-4",children:e(A,{href:route("db.show",a.id),children:"Back to Database"})}),e(E,{details:p}),e("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg shadow-sm",children:r("div",{className:"py-4 px-4 mx-auto max-w-7xl",children:[r("div",{className:"flex items-center justify-between",children:[e("div",{children:r("h2",{className:"mt-1 mb-2 text-xl font-bold leading-none text-gray-900 md:text-2xl dark:text-white",children:[a.name," (",a.conn.host,")"]})}),r("small",{className:"text-end",children:[e(v,{className:"mr-2 h-6 w-6 text-gray-600 dark:text-white hover:text-gray-700 hover:dark:text-gray-300 inline hover:cursor-pointer",onClick:()=>d(!0),title:"Delete table"}),e(B,{className:"md:ml-2 ml-1 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:w,title:"Refresh tables"}),e(z,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:y,title:"Get size and row counts"})]})]}),e("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"Tables"}),l.length>0?e("ul",{className:"max-w-md space-y-1 text-gray-500 list-none list-inside dark:text-gray-400",children:l.map(t=>r("li",{children:[e("a",{href:route("db.table.columns.show",[a.id,t.id]),children:t.name}),t.row_count!==null?r("span",{className:"ml-1 bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-indigo-900 dark:text-indigo-300",children:[x(t.row_count)," rows"]}):null,t.size_mb!==null?r("span",{className:"ml-1 bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300",children:[x(t.size_mb)," MB"]}):null]},t.id))}):e("p",{className:"text-md my-1 font-semibold text-gray-600 md:text-lg dark:text-gray-300",children:"There are no tables. Perhaps your connection is not correct"})]})})]}),e(m,{show:f,size:"md",children:e(m.Body,{children:r("div",{className:"text-center",children:[e("h3",{className:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this table?"}),r("div",{className:"flex justify-center gap-4",children:[e(h,{color:"failure",onClick:b,children:"Yes, I'm sure"}),e(h,{onClick:()=>d(!1),color:"gray",children:"No, cancel"})]})]})})})]})}export{P as default};
