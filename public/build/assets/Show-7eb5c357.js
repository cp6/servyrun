import{A as y}from"./AuthenticatedLayout-e0b7f8ec.js";import{u as n,r as c,j as r,a as e,H as N}from"./app-3b14edf2.js";import{M as m,B as h}from"./Toast-1f814f61.js";import"./Table-29b362e9.js";import{H as k,j as v,l as B}from"./index.esm-b46f3593.js";import{R as z}from"./Alert-10dd726c.js";import{a as u}from"./axios-468742d6.js";import{B as E}from"./BackButton-d8b9f37c.js";import"./ApplicationLogo-30229999.js";import"./transition-da3d9d06.js";function F({auth:x}){const g=n().props.alert,a=n().props.resource,i=n().props.tables,l=n().props.auth.user,[p,d]=c.useState(!1),[S,o]=c.useState(!1),f=()=>{const t={method:"DELETE",headers:{"X-CSRF-TOKEN":document.getElementsByName("csrf-token")[0].getAttribute("content")}};fetch(route("db.show.tables.destroy",[a.id]),t).then(s=>{s.redirected&&(window.location.href=s.url)})},b=()=>{o(!0);const t={headers:{Authorization:`Bearer ${l.api_token}`}};u.get(route("api.db.refresh",a.id),t).then(s=>{window.location.reload()}).catch(s=>{console.log("Error refreshing tables"),o(!1)})},w=()=>{o(!0);const t={headers:{Authorization:`Bearer ${l.api_token}`}};u.get(route("api.db.table.size",a.id),t).then(s=>{window.location.reload()}).catch(s=>{console.log("Error refreshing tables"),o(!1)})};return r(y,{auth:x,header:e("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:a.name+" tables"}),children:[e(N,{title:a.name+" tables"}),r("div",{className:"py-8 px-2 mx-auto max-w-7xl lg:py-10",children:[e("div",{className:"flex flex-wrap gap-2 mb-4",children:e(E,{href:route("db.show",a.id),children:"Back to Database"})}),e(z,{details:g}),e("section",{className:"bg-white/50 dark:bg-gray-700 rounded-lg shadow-sm",children:r("div",{className:"py-4 px-4 mx-auto max-w-7xl",children:[r("div",{className:"flex items-center justify-between",children:[e("div",{children:r("h2",{className:"mt-1 mb-2 text-xl font-bold leading-none text-gray-900 md:text-2xl dark:text-white",children:[a.name," (",a.conn.host,")"]})}),r("small",{className:"text-end",children:[e(k,{className:"mr-2 h-6 w-6 text-gray-600 dark:text-white hover:text-gray-700 hover:dark:text-gray-300 inline hover:cursor-pointer",onClick:()=>d(!0),title:"Delete table"}),e(v,{className:"md:ml-2 ml-1 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:b,title:"Refresh tables"}),e(B,{className:"md:ml-3 ml-2 h-6 w-6 text-gray-600 dark:text-white inline hover:cursor-pointer",onClick:w,title:"Get size and row counts"})]})]}),e("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"Tables"}),i.length>0?e("ul",{className:"max-w-md space-y-1 text-gray-500 list-none list-inside dark:text-gray-400",children:i.map(t=>r("li",{children:[e("a",{href:route("db.table.columns.show",[a.id,t.id]),children:t.name}),t.row_count!==null?r("span",{className:"ml-1 bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-indigo-900 dark:text-indigo-300",children:[new Intl.NumberFormat("en-IN",{maximumSignificantDigits:3}).format(t.row_count)," rows"]}):null,t.size_mb!==null?r("span",{className:"ml-1 bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300",children:[new Intl.NumberFormat("en-IN",{maximumSignificantDigits:3}).format(t.size_mb)," MB"]}):null]},t.id))}):e("p",{className:"text-md my-1 font-semibold text-gray-600 md:text-lg dark:text-gray-300",children:"There are no tables. Perhaps your connection is not correct"})]})})]}),e(m,{show:p,size:"md",children:e(m.Body,{children:r("div",{className:"text-center",children:[e("h3",{className:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this table?"}),r("div",{className:"flex justify-center gap-4",children:[e(h,{color:"failure",onClick:f,children:"Yes, I'm sure"}),e(h,{onClick:()=>d(!1),color:"gray",children:"No, cancel"})]})]})})})]})}export{F as default};
